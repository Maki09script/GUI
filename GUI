-- SERVICES
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- CONFIGURATION
local BACKGROUND_COLOR = Color3.fromRGB(0, 0, 0)
local ACCENT_COLOR = Color3.fromRGB(255, 255, 255)
local TITLE_TEXT = "Gawang Maki V2"
local FONT = Enum.Font.SourceSansBold

-- MENU ITEMS
local MENU_ITEMS = {
    "Cavite Roleplay",
    "Urban Roleplay",
    "The Billionaire City",
    "Los Santos City RP",
    "Lucio City RP",
    "La Urban RP",
    "Maharlika RP",
    "Silangan Metro City", 
    "Solis RP", -- âœ… NEW MENU
    "OTHERS",
}

-- CREATE UI
local function createScriptHubUI()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "ScriptHubUI"
    ScreenGui.Parent = PlayerGui
    ScreenGui.ResetOnSpawn = false

    -- MAIN FRAME
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0.5, 0, 0.5, 0)
    MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
    MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    MainFrame.BackgroundColor3 = BACKGROUND_COLOR
    MainFrame.BorderSizePixel = 0
    MainFrame.Parent = ScreenGui

    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 8)
    UICorner.Parent = MainFrame

    -- TITLE BAR
    local TitleBar = Instance.new("TextLabel")
    TitleBar.Size = UDim2.new(1, 0, 0.1, 0)
    TitleBar.BackgroundColor3 = BACKGROUND_COLOR
    TitleBar.BorderSizePixel = 0
    TitleBar.Font = FONT
    TitleBar.Text = TITLE_TEXT
    TitleBar.TextColor3 = ACCENT_COLOR
    TitleBar.TextSize = 20
    TitleBar.TextXAlignment = Enum.TextXAlignment.Left
    TitleBar.Parent = MainFrame

    local TitlePadding = Instance.new("UIPadding")
    TitlePadding.PaddingLeft = UDim.new(0, 10)
    TitlePadding.Parent = TitleBar

    -- CENTER PANEL
    local CenterPanel = Instance.new("Frame")
    CenterPanel.Size = UDim2.new(0.9, 0, 0.85, 0)
    CenterPanel.Position = UDim2.new(0.5, 0, 0.55, 0)
    CenterPanel.AnchorPoint = Vector2.new(0.5, 0.5)
    CenterPanel.BackgroundTransparency = 1
    CenterPanel.Parent = MainFrame

    -- LEFT PANEL
    local LeftPanel = Instance.new("ScrollingFrame")
    LeftPanel.Size = UDim2.new(0.45, 0, 1, 0)
    LeftPanel.BackgroundColor3 = BACKGROUND_COLOR
    LeftPanel.BorderSizePixel = 0
    LeftPanel.ScrollBarThickness = 6
    LeftPanel.Parent = CenterPanel

    local LeftListLayout = Instance.new("UIListLayout")
    LeftListLayout.VerticalAlignment = Enum.VerticalAlignment.Top
    LeftListLayout.Padding = UDim.new(0, 15)
    LeftListLayout.Parent = LeftPanel

    local LeftPadding = Instance.new("UIPadding")
    LeftPadding.PaddingTop = UDim.new(0, 10)
    LeftPadding.Parent = LeftPanel

    -- USER INFO
    local UserInfo = Instance.new("Frame")
    UserInfo.Size = UDim2.new(1, 0, 0.15, 0)
    UserInfo.BackgroundTransparency = 1
    UserInfo.Parent = LeftPanel

    -- PROFILE IMAGE
    local ProfileImage = Instance.new("ImageLabel")
    ProfileImage.Size = UDim2.new(0, 50, 0, 50)
    ProfileImage.Position = UDim2.new(0.02, 0, 0.1, 0)
    ProfileImage.BackgroundTransparency = 1
    ProfileImage.Parent = UserInfo

    local content = Players:GetUserThumbnailAsync(
        LocalPlayer.UserId,
        Enum.ThumbnailType.HeadShot,
        Enum.ThumbnailSize.Size420x420
    )
    ProfileImage.Image = content

    -- USERNAME
    local UsernameLabel = Instance.new("TextLabel")
    UsernameLabel.Size = UDim2.new(0.7, 0, 0.4, 0)
    UsernameLabel.Position = UDim2.new(0.25, 0, 0.2, 0)
    UsernameLabel.BackgroundTransparency = 1
    UsernameLabel.Font = FONT
    UsernameLabel.Text = LocalPlayer.Name
    UsernameLabel.TextColor3 = ACCENT_COLOR
    UsernameLabel.TextSize = 18
    UsernameLabel.TextXAlignment = Enum.TextXAlignment.Left
    UsernameLabel.Parent = UserInfo

    -- ONLINE STATUS
    local StatusFrame = Instance.new("Frame")
    StatusFrame.Size = UDim2.new(0, 12, 0, 12)
    StatusFrame.Position = UDim2.new(0.25, 0, 0.7, 0)
    StatusFrame.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
    StatusFrame.BorderSizePixel = 0
    StatusFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    StatusFrame.Parent = UserInfo

    local StatusUICorner = Instance.new("UICorner")
    StatusUICorner.CornerRadius = UDim.new(1, 0)
    StatusUICorner.Parent = StatusFrame

    local StatusLabel = Instance.new("TextLabel")
    StatusLabel.Size = UDim2.new(0.4, 0, 0.3, 0)
    StatusLabel.Position = UDim2.new(0.32, 0, 0.7, 0)
    StatusLabel.BackgroundTransparency = 1
    StatusLabel.Font = Enum.Font.SourceSans
    StatusLabel.Text = "Online"
    StatusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
    StatusLabel.TextSize = 14
    StatusLabel.TextXAlignment = Enum.TextXAlignment.Left
    StatusLabel.Parent = UserInfo

    -- RIGHT PANEL
    local RightPanel = Instance.new("ScrollingFrame")
    RightPanel.Size = UDim2.new(0.45, 0, 1, 0)
    RightPanel.Position = UDim2.new(0.55, 0)
    RightPanel.BackgroundColor3 = BACKGROUND_COLOR
    RightPanel.BorderSizePixel = 0
    RightPanel.ScrollBarThickness = 6
    RightPanel.Parent = CenterPanel

    local RightListLayout = Instance.new("UIListLayout")
    RightListLayout.VerticalAlignment = Enum.VerticalAlignment.Top
    RightListLayout.Padding = UDim.new(0, 15)
    RightListLayout.Parent = RightPanel

    -- DEFAULT PLACEHOLDER TEXT
    local PlaceholderLabel = Instance.new("TextLabel")
    PlaceholderLabel.Size = UDim2.new(1, -20, 0, 60)
    PlaceholderLabel.Position = UDim2.new(0, 10, 0, 50)
    PlaceholderLabel.BackgroundTransparency = 1
    PlaceholderLabel.Font = FONT
    PlaceholderLabel.TextColor3 = ACCENT_COLOR
    PlaceholderLabel.TextSize = 16
    PlaceholderLabel.Text = "SUGGEST SYUDAD PARA MA ADD\nPRESS M TO HIDE/SHOW THE GUI\nMAKI ON TOP"
    PlaceholderLabel.TextWrapped = true
    PlaceholderLabel.Parent = RightPanel

    -- BUTTON CREATION FUNCTION
    local function CreateButton(name, callback)
        local btn = Instance.new("TextButton")
        btn.Size = UDim2.new(1, -20, 0, 30)
        btn.BackgroundColor3 = BACKGROUND_COLOR
        btn.BorderSizePixel = 0
        btn.Font = FONT
        btn.Text = name
        btn.TextColor3 = ACCENT_COLOR
        btn.TextSize = 16
        btn.Parent = RightPanel
        btn.MouseButton1Click:Connect(callback)
    end

    -- POPULATE LEFT MENU
    for _, itemText in ipairs(MENU_ITEMS) do
        local MenuItem = Instance.new("TextButton")
        MenuItem.Size = UDim2.new(1, -20, 0, 30)
        MenuItem.BackgroundColor3 = BACKGROUND_COLOR
        MenuItem.BorderSizePixel = 0
        MenuItem.Font = FONT
        MenuItem.Text = itemText
        MenuItem.TextColor3 = ACCENT_COLOR
        MenuItem.TextSize = 16
        MenuItem.Parent = LeftPanel

        MenuItem.MouseButton1Click:Connect(function()
            -- Clear old right-panel buttons
            for _, child in ipairs(RightPanel:GetChildren()) do
                if child:IsA("TextButton") then
                    child:Destroy()
                end
            end
            PlaceholderLabel.Visible = false

            -- CAVITE
            if itemText == "Cavite Roleplay" then
                local function CreateCaviteButton(name, itemName)
                    CreateButton(name, function()
                        ReplicatedStorage.BM_Storage.Remotes.Buy:FireServer(0, itemName)
                    end)
                end
                CreateCaviteButton("Heavy Helmet", "Heavy Helmet")
                CreateCaviteButton("Heavy Vest", "Heavy Vest")
                CreateCaviteButton("SP", "Silenced Pistol")
                CreateCaviteButton("Knife", "Tactical Knife")

            -- URBAN
            elseif itemText == "Urban Roleplay" then
                CreateButton("SP", function() ReplicatedStorage.BiliToolEvent:FireServer("Suppressed Pistols", 0, "RACCMETHOD") end)
                CreateButton("AmmoBox", function() ReplicatedStorage.BiliToolEvent:FireServer("AmmoBox", 0, "RACCMETHOD") end)
                CreateButton("Sandwich", function() ReplicatedStorage.UwUCafeFolder.BuyTool:FireServer("Sandwich", 0, "RACCMETHOD") end)
                CreateButton("Matcha Latte", function() ReplicatedStorage.UwUCafeFolder.BuyTool:FireServer("Matcha Latte", 0, "RACCMETHOD") end)
                CreateButton("Oxy", function() ReplicatedStorage.EMSFolder.PabiliTool:FireServer("Oxy", 0, "RACCMETHOD") end)

            -- THE BILLIONAIRE CITY
            elseif itemText == "The Billionaire City" then
                CreateButton("UNLI AYUDA", function()
                    for _, tool in pairs(ReplicatedStorage:GetChildren()) do
                        if tool:IsA("Tool") then
                            tool:Clone().Parent = LocalPlayer.Backpack
                        end
                    end
                end)
                local tbcItems = {"Combo 3","Pill","Oxy","Normal Pistol","Pistolbody","SharkFang","Lockpick","Glass","Bottle","Knife","Blueprint"}
                for _, itemName in ipairs(tbcItems) do
                    CreateButton(itemName, function() ReplicatedStorage.BuyTbcItemEvent:FireServer(itemName, 1, "RACCMETHOD") end)
                end

            -- LOS SANTOS CITY RP
            elseif itemText == "Los Santos City RP" then
                local function createLSButton(name, gunName)
                    CreateButton(name, function()
                        local args = { gunName, 0, "MakiV371" }
                        game:GetService("ReplicatedStorage"):WaitForChild("GunShop"):WaitForChild("Events"):WaitForChild("Purchase"):FireServer(unpack(args))
                    end)
                end
                createLSButton("SP", "SP")
                createLSButton("Combat Pistol", "Combat Pistol")
                createLSButton("Seeds", "Seeds")
                createLSButton("Watering Can", "Watering Can")

            -- LUCIO CITY RP
            elseif itemText == "Lucio City RP" then
                local function createLSButton(name, gunName)
                    CreateButton(name, function()
                        local args = { gunName, 0, "MakiV371" }
                        game:GetService("ReplicatedStorage"):WaitForChild("GunShop"):WaitForChild("Events"):WaitForChild("Purchase"):FireServer(unpack(args))
                    end)
                end
                createLSButton("Glock-17", "Glock-17")
                createLSButton("Oxy", "Oxy")
                createLSButton("Radio", "Radio")
                createLSButton("Silenced", "Silenced")
                createLSButton("Vector", "Vector")

            -- LA URBAN RP
            elseif itemText == "La Urban RP" then
                local function createLaUrbanButton(name, gunName)
                    CreateButton(name, function()
                        local args = { gunName, 0, "MakiV371" }
                        game:GetService("ReplicatedStorage"):WaitForChild("GunShop"):WaitForChild("Events"):WaitForChild("Purchase"):FireServer(unpack(args))
                    end)
                end
                createLaUrbanButton("SP", "SP")
                createLaUrbanButton("Combat Pistol", "Combat Pistol")
                createLaUrbanButton("Seeds", "Seeds")
                createLaUrbanButton("Watering Can", "Watering Can")

            -- Maharlika RP
            elseif itemText == "Maharlika RP" then
                local function createMaharlikaRPButton(name, gunName)
                    CreateButton(name, function()
                        local args = { gunName, 0, "MakiV371" }
                        game:GetService("ReplicatedStorage"):WaitForChild("GunShop"):WaitForChild("Events"):WaitForChild("Purchase"):FireServer(unpack(args))
                    end)
                end
                createMaharlikaRPButton("Bat", "Bat")
                createMaharlikaRPButton("Silenced Pistol", "Silenced Pistol")
                createMaharlikaRPButton("Glock-17", "Glock-17")
                createMaharlikaRPButton("NEW ITEM", "NEW ITEM") 

            -- Silangan Metro City
            elseif itemText == "Silangan Metro City" then
                local function createNewCityButton(name, itemName)
                    CreateButton(name, function()
                        ReplicatedStorage.UwUCafeFolder.BuyTool:FireServer(itemName, 0, "RACCMETHOD")
                    end)
                end
                createNewCityButton("Silenced Pistol", "Silenced Pistol")
                createNewCityButton("Pistol", "Pistol")

            -- Solis RP
            elseif itemText == "Solis RP" then
                local function createNewCityRPButton(name, itemName)
                    CreateButton(name, function()
                        ReplicatedStorage.GunShop.Events.Purchase:FireServer(itemName, 0, "RACCMETHOD")
                    end)
                end
                createNewCityRPButton("Pistol", "Pistol")

            -- OTHERS
            elseif itemText == "OTHERS" then
                CreateButton("Infinite Yield", function()
                    loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()
                end)
            end
        end)
    end

    return MainFrame, TitleBar
end

-- CREATE UI
local MainFrame, TitleBar = createScriptHubUI()

-- DRAG LOGIC
local isDragging = false
local dragStartPos = Vector2.new()
local frameStartPos

TitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        isDragging = true
        dragStartPos = input.Position
        frameStartPos = MainFrame.Position
        MainFrame.AnchorPoint = Vector2.new(0, 0)
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        isDragging = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        if isDragging then
            local delta = input.Position - dragStartPos
            MainFrame.Position = UDim2.new(0, frameStartPos.X.Offset + delta.X, 0, frameStartPos.Y.Offset + delta.Y)
        end
    end
end)

-- TOGGLE GUI WITH M
local guiVisible = true
UserInputService.InputBegan:Connect(function(input, gp)
    if gp then return end
    if input.KeyCode == Enum.KeyCode.M then
        guiVisible = not guiVisible
        MainFrame.Visible = guiVisible
    end
end)
